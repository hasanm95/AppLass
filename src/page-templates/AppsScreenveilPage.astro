---
import Layout from '../layouts/Layout.astro';
import appLogoImg from '@/assets/logo.png';
import { Footer } from "@/components/common";
import Navbar from "@/components/common/Navbar.astro";
import { ScreenVeilHero } from "@/components/apps/screenveil/ScreenVeilHero";
import { PainPointsSection } from "@/components/apps/screenveil/PainPointsSection";
import { FeatureGrid } from "@/components/apps/screenveil/FeatureGrid";
import { TechnicalAdvantage } from "@/components/apps/screenveil/TechnicalAdvantage";
import { PrivacySection } from "@/components/apps/screenveil/PrivacySection";
import { TestimonialsSection } from "@/components/apps/screenveil/TestimonialsSection";
import { FAQSection } from "@/components/apps/screenveil/FAQSection";
import { StickyDownloadBar } from "@/components/apps/screenveil/StickyDownloadBar";
import { SCREENVEIL_DATA } from "@/constants/screenveil-data";
import { getDictionary } from "@/i18n/get-dictionary";
import { i18nConfig } from "@/i18n/config";
import { getImage } from "astro:assets";
import screenveilHeroImg from "@/assets/apps/screenveil/hero-mockup.png";

interface Props {
  lang: typeof i18nConfig.locales[number];
}

const { lang } = Astro.props;
const dict = await getDictionary(lang as any);

const meta = dict.metadata?.screenveil || {};

const optimizedHero = await getImage({ src: screenveilHeroImg, format: "webp" });
const optimizedAppLogo = await getImage({ src: appLogoImg, format: 'webp', width: 64, height: 64 });

---

<Layout 
  title={meta.title || "ScreenVeil: The Safest Screen Filter for Total Digital Privacy"}
  description={meta.description || "Protect your data from prying eyes with ScreenVeil. A lightweight, secure screen overlay for Android. No data collection, 100% offline."}
  keywords={meta.keywords}
  ogTitle={meta.ogTitle}
  ogDescription={meta.ogDescription}
  ogImage={meta.ogImage}
  ogUrl={meta.ogUrl}
  lang={lang}
>
  <div class="bg-[#020617]">
    <Navbar translations={dict.nav} currentLang={lang} variant='dark'  />

    <div class="flex-1 overflow-x-hidden">
      {/* SoftwareApplication Schema for SEO - triggers rich results with star ratings */}
      <script
        type="application/ld+json"
        is:inline
        set:html={JSON.stringify(SCREENVEIL_DATA.schema.softwareApplication)}
      />
      <ScreenVeilHero translations={dict.screenveil?.hero} heroImageSrc={optimizedHero.src} />
      <PainPointsSection translations={dict.screenveil?.painPoints} />
      <FeatureGrid translations={dict.screenveil?.features} />
      <TechnicalAdvantage translations={dict.screenveil?.technical} />
      <PrivacySection translations={dict.screenveil?.privacy} />
      <TestimonialsSection translations={dict.screenveil?.testimonials} />
      <FAQSection client:idle />
    </div>

    <Footer translations={dict.footer} variant="dark"  logoSrc={optimizedAppLogo.src} />
    <StickyDownloadBar client:idle translations={dict.screenveil?.hero} />
  </div>
</Layout>
