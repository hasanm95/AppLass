---
import Layout from './Layout.astro';
import { Navbar, Footer } from "@/components/common";
import { DocsSidebar } from "@/components/docs/docs-sidebar";
import { Zap, Shield, Smartphone, BookOpen } from "lucide-react";
import { getDictionary } from "@/i18n/get-dictionary";
import { getImage } from 'astro:assets';
import appLogoImg from '@/assets/logo.png';

interface Props {
  lang: string;
  app?: 'fomogen' | 'mindful-guard' | 'screenveil' | 'hub';
  title?: string;
  description?: string;
  keywords?: string;
  ogTitle?: string;
  ogDescription?: string;
  ogImage?: string;
  ogUrl?: string;
}

const { 
  lang, 
  app = 'hub', 
  title = 'Documentation', 
  description = 'User Guide and Documentation',
  keywords,
  ogTitle,
  ogDescription,
  ogImage,
  ogUrl
} = Astro.props;

const dict = await getDictionary(lang as any);
const optimizedAppLogo = await getImage({ src: appLogoImg, format: 'webp', width: 64, height: 64 });
---

<Layout 
  title={title} 
  description={description} 
  keywords={keywords}
  ogTitle={ogTitle}
  ogDescription={ogDescription}
  ogImage={ogImage}
  ogUrl={ogUrl}
  lang={lang}
>
  <div class="flex min-h-screen flex-col bg-white">
    <Navbar client:load translations={dict.nav} currentLang={lang} logoSrc={optimizedAppLogo.src}>
      <div slot="customBranding" class="flex items-center gap-2">
        {app === 'fomogen' && (
          <>
            <Zap className="h-5 w-5 fill-blue-600 text-blue-600" />
            <span class="text-lg font-black tracking-tighter text-slate-900">
              FOMO<span class="text-blue-600">GEN</span>
            </span>
          </>
        )}
        {app === 'mindful-guard' && (
          <>
            <Shield className="h-5 w-5 fill-slate-900 text-slate-900" />
            <span class="text-lg font-black tracking-tighter text-slate-900 uppercase">
              Mindful<span class="text-slate-400">Guard</span>
            </span>
          </>
        )}
        {app === 'screenveil' && (
          <>
            <Smartphone className="h-5 w-5 fill-blue-600 text-blue-600" />
            <span class="text-lg font-black tracking-tighter text-slate-900 uppercase">
              Screen<span class="text-blue-600">Veil</span>
            </span>
          </>
        )}
        {app === 'hub' && (
          <>
            <BookOpen className="h-5 w-5 text-blue-600 fill-blue-600" />
            <span class="text-lg font-black tracking-tighter text-slate-900">
              App<span class="text-blue-600">Lass</span> <span class="text-slate-400 text-sm font-bold">Docs</span>
            </span>
          </>
        )}
      </div>
    </Navbar>

    {app === 'hub' ? (
      <main class="flex-1">
        <div class="section-container pt-32 pb-24">
          <slot />
        </div>
      </main>
    ) : (
      <div class="section-container flex flex-1 pt-32">
        <DocsSidebar client:load lang={lang} pathname={Astro.url.pathname} />
        <main class="flex-1 pb-24 lg:pl-16">
          <div class="max-w-4xl pt-8">
            <slot />
          </div>
        </main>
      </div>
    )}

    <Footer translations={dict.footer} logoSrc={optimizedAppLogo.src} />
  </div>
</Layout>
