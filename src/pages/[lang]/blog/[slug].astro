---
import { i18nConfig } from "@/i18n/config";
import { getBlogPosts } from "@/lib/blog";
import BlogPostPage from "@/page-templates/BlogPostPage.astro";

export async function getStaticPaths() {
  const nonDefaultLocales = i18nConfig.locales.filter(
    (l) => l !== i18nConfig.defaultLocale
  );
  
  const paths = await Promise.all(nonDefaultLocales.map(async (lang) => {
    const posts = await getBlogPosts(lang);
    return posts.map((post: any) => ({
      params: { lang, slug: post.slug },
    }));
  }));

  return paths.flat();
}

const { lang, slug } = Astro.params;
---

<BlogPostPage lang={lang as any} slug={slug!} />
